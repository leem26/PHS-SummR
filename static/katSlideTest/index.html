<!DOCTYPE html>
<html lang="" xml:lang="">
  <head>
    <title>Mathematics review: matrices and functions</title>
    <meta charset="utf-8" />
    <meta name="author" content="Kat Sadikova" />
    <meta name="date" content="2020-08-07" />
    <script src="index_files/header-attrs/header-attrs.js"></script>
    <link href="index_files/remark-css/default.css" rel="stylesheet" />
    <link href="index_files/remark-css/default-fonts.css" rel="stylesheet" />
    <script src="index_files/htmlwidgets/htmlwidgets.js"></script>
    <script src="index_files/plotly-binding/plotly.js"></script>
    <script src="index_files/typedarray/typedarray.min.js"></script>
    <script src="index_files/jquery/jquery.min.js"></script>
    <link href="index_files/crosstalk/css/crosstalk.css" rel="stylesheet" />
    <script src="index_files/crosstalk/js/crosstalk.min.js"></script>
    <link href="index_files/plotly-htmlwidgets-css/plotly-htmlwidgets.css" rel="stylesheet" />
    <script src="index_files/plotly-main/plotly-latest.min.js"></script>
  </head>
  <body>
    <textarea id="source">
class: center, middle, inverse, title-slide

# Mathematics review: matrices and functions
### Kat Sadikova
### 2020-08-07

---


class:middle,center



&lt;style type="text/css"&gt;
/* custom.css */
.title-slide {
  background-image: url("img/camp.svg");
  background-size: cover;
}

.left-code {
  #color: #777;
  width: 43%;
  height: 92%;
  float: left;
  #font-size: 0.8em;
  position: absolute;
}
.right-plot {
  width: 50%;
  float: right;
  padding-left: 1%;
}
.left-col {
  width: 40%;
  float: left;
  position: absolute;
}
.right-col {
  width: 50%;
  float: right;
  padding-left: 5%;
}
.plot-callout {
  height: 225px;
  width: 450px;
  bottom: 5%;
  right: 5%;
  position: absolute;
  padding: 0px;
  z-index: 100;
}
.plot-callout img {
  width: 100%;
  border: 4px solid #23373B;
}

h4 {
  color: #F97B64;
  font-size: 22px;
}

h1, h2, h3, h4 {
  margin-top:0;
}

.inverse h1, .inverse h2, .inverse h3 {
  color: #1F4257;
}
.remark-slide thead, .remark-slide tr:nth-child(2n) {
  background-color: white;
}
.title-slide, .title-slide h1, .title-slide h2, .title-slide h3 {
color: #FFFFFF;
}
&lt;/style&gt;



&lt;!-- # Check-in --&gt;

&lt;!-- Please answer a few questions in this [check-in](https://forms.gle/TLtGxnFXAfd1jHYZ6) before we begin. --&gt;


.left[
# Part 1: Matrices and linear algebra basics
]

#### Intuition and basic tools relevant for quantitative methods in population health sciences

---

class:middle,center
.left[
### Scalars, vectors, matrices
]

`\(a = a \text{ , a scalar}\)`

&lt;br&gt;
--

`\(\mathbf{y} =\begin{bmatrix}y_1 \\ y_2 \\ \vdots \\ y_n\end{bmatrix}\text{,  a vector of length } n\)`

&lt;br&gt;
--

`\(\mathbf{X} = \begin{bmatrix} x_{11} &amp; x_{12} &amp; \cdots &amp; x_{1p} \\ x_{21} &amp; x_{22} &amp; \cdots &amp; x_{2p} \\ \vdots &amp;\vdots &amp; \ddots &amp; \vdots \\x_{n1} &amp; x_{n2} &amp; \cdots &amp; x_{np}\end{bmatrix} \text{,  an }n \times p \text{ matrix}\)`


---


.left[
### Note on dimensions
]

.right-col[

![](https://media.giphy.com/media/5yLgocAcF0DYJHZtQqs/giphy.gif)


Imagine this very happy Ron Swanson **Rowing a Canoe** and remember that **Rows come before Columns** when indexing elements of a matrix
]

.left-col[
We read dimensions like `\(n \times p\)` as **rows** by **columns**. `\(X\)` is a 3x4 matrix:

`$$\mathbf{X}_{3 \times 4} = \begin{bmatrix} x_{11} &amp; x_{12} &amp; x_{13} &amp; x_{14}\\ x_{21} &amp; x_{22} &amp; x_{23} &amp; x_{24}\\ x_{31} &amp; x_{32} &amp; x_{33} &amp; x_{34} \end{bmatrix}_{3\times 4}$$`
&lt;br&gt;
--

Individual elements are indexed in the same *row-column* order: `\(x_{23}\)` is the element in the second row and third column.
]
---



class:middle
.left[
### Data example
]

.left-col[
Let's look at a simple example - data stored in a matrix `\(\mathbf{X}\)` with 10 individuals and 4 variables:
- age in years
- height in inches
- a dichotomous indicator of whether the individual likes dogs
- year of birth
]


.right-col[

`\(\mathbf{X} = \begin{bmatrix} 25 &amp; 67 &amp; \cdots &amp; 1995 \\ 38 &amp; 63 &amp; \cdots &amp; 1982 \\ \vdots &amp;\vdots &amp; \ddots &amp; \vdots \\ 41 &amp; 59 &amp; \cdots &amp; 1979 \end{bmatrix}\)`


`\(age_{1} = 25, \text{ age of participant 1 }\)`


`\(\mathbf{age} = \begin{bmatrix} 25 \\ 38 \\ \vdots \\ 41 \end{bmatrix} \text{,  ages of all the participants}\)`
]
---

.left[
### Data example: in R
]

__Build the data set__


```r
set.seed(6789)
n &lt;- 10
dat &lt;- data.frame(
  age = round(runif(n, 22, 45)), height = round(rnorm(n, 66, 4)), likes_dogs = rbinom(n, 1, .53)
)
dat$yob &lt;- 2020 - dat$age
dat &lt;- as.matrix(dat)

dat
```

```
##       age height likes_dogs  yob
##  [1,]  25     67          0 1995
##  [2,]  38     63          1 1982
##  [3,]  35     66          1 1985
##  [4,]  36     70          1 1984
##  [5,]  23     62          1 1997
##  [6,]  26     73          1 1994
##  [7,]  44     68          0 1976
##  [8,]  23     70          1 1997
##  [9,]  25     70          1 1995
## [10,]  41     59          0 1979
```
---

.left[
### Data example: in R
]

__What are the dimensions of this matrix?__

```r
# both dimensions
dim(dat)
```

```
## [1] 10  4
```

```r
# number of rows
nrow(dat)
```

```
## [1] 10
```

```r
# number of columns
ncol(dat)
```

```
## [1] 4
```
---


.left[
### Data example: in R
]

__Let's inspect parts of this matrix (vectors and scalars)__


```r
# Extract everyone's age (column vector)
dat[,1]
```

```
##  [1] 25 38 35 36 23 26 44 23 25 41
```

```r
# Find out if participant 2 likes dogs (scalar)
dat[2,3]
```

```
## likes_dogs 
##          1
```

```r
# What does the data for participant 7 look like? (row vector)
dat[7,]
```

```
##        age     height likes_dogs        yob 
##         44         68          0       1976
```
---

### The geometry of vectors
.left-col[
Let's look at the age, height and shoe size of participants 1 and 2
`\(\mathbf{x}_1 = \begin{bmatrix} 25 \\ 67 \\10.5 \end{bmatrix} \mathbf{x}_2 = \begin{bmatrix} 38 \\ 66.5 \\ 7 \end{bmatrix}\)`

The more attributes we measure about people, the higher-dimensional the space -- and the more precisely we can describe each person (they're not near anyone else in space).
]

.right-plot[
<div id="htmlwidget-917b0c9d60dce2073e5e" style="width:500px;height:500px;" class="plotly html-widget"></div>
<script type="application/json" data-for="htmlwidget-917b0c9d60dce2073e5e">{"x":{"visdat":{"deac1c122ead":["function () ","plotlyVisDat"]},"cur_data":"deac1c122ead","attrs":{"deac1c122ead":{"x":{},"z":{},"y":{},"mode":"markers","color":{},"size":[4,4,0,0],"colors":["red","white","blue"],"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"scatter3d"}},"layout":{"width":500,"height":500,"margin":{"b":40,"l":60,"t":25,"r":10},"scene":{"yaxis":{"title":"age"},"xaxis":{"title":"shoe size"},"zaxis":{"title":"height"},"camera":{"up":{"x":0,"y":0,"z":1},"eye":{"x":2.5,"y":0.1,"z":0.1},"center":{"x":0,"y":0,"z":0}}},"showlegend":false,"hovermode":"closest"},"source":"A","config":{"showSendToCloud":false},"data":[{"x":[7],"z":[66.5],"y":[31],"mode":"markers","type":"scatter3d","name":"blue","marker":{"color":"rgba(255,0,0,1)","size":[100],"sizemode":"area","line":{"color":"rgba(255,0,0,1)"}},"textfont":{"color":"rgba(255,0,0,1)","size":100},"error_y":{"color":"rgba(255,0,0,1)","width":100},"error_x":{"color":"rgba(255,0,0,1)","width":100},"line":{"color":"rgba(255,0,0,1)","width":100},"frame":null},{"x":[6,11],"z":[60,70],"y":[25,35],"mode":"markers","type":"scatter3d","name":"clear","marker":{"color":"rgba(255,255,255,1)","size":[10,10],"sizemode":"area","line":{"color":"rgba(255,255,255,1)"}},"textfont":{"color":"rgba(255,255,255,1)","size":10},"error_y":{"color":"rgba(255,255,255,1)","width":10},"error_x":{"color":"rgba(255,255,255,1)","width":10},"line":{"color":"rgba(255,255,255,1)","width":10},"frame":null},{"x":[10.5],"z":[67],"y":[30],"mode":"markers","type":"scatter3d","name":"red","marker":{"color":"rgba(0,0,255,1)","size":[100],"sizemode":"area","line":{"color":"rgba(0,0,255,1)"}},"textfont":{"color":"rgba(0,0,255,1)","size":100},"error_y":{"color":"rgba(0,0,255,1)","width":100},"error_x":{"color":"rgba(0,0,255,1)","width":100},"line":{"color":"rgba(0,0,255,1)","width":100},"frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
]
---


class:middle
.left[
### Transposing vectors and matrices
]

We can flip a vector on its side by **transposing** it.

`\(\mathbf{y} =\begin{bmatrix}y_1 \\ y_2 \\ \vdots \\ y_n\end{bmatrix}\text{,  a vector of length } n\)`

`\(\mathbf{y}^T =\begin{bmatrix}y_1 &amp; y_2 &amp; \cdots &amp; y_n\end{bmatrix}\text{,  a row vector of length } n\)`

**Note:** We may also refer to transposed vectors (and matrices) with "prime" notation: `\(\mathbf{y}^T = \mathbf{y}'\)`
(Not to be confused with a derivative!)
---


class:middle
.left[
### Transposing vectors and matrices
]

We can also think of vectors as single-columned matrices:

- A column vector `\(\mathbf{y}\)` of length `\(n\)` has dimensions `\(n \times 1\)`.
.center[
`\(\begin{bmatrix}y_1 \\ y_2 \\ \vdots \\ y_n\end{bmatrix}_{n\times 1}\)`
]


- A row vector `\(\mathbf{y}'\)`  of length `\(n\)` has dimensions `\(1 \times n\)`.
.center[
`\(\begin{bmatrix}y_1 &amp; y_2 &amp; \cdots &amp; y_n\end{bmatrix}_{1\times n}\)`
]

Thinking about vectors this way will be really handy when we multiply vectors and matrices!

---


class:middle
.left[
### Transposing vectors and matrices
]

We can also transpose matrices

`\(\mathbf{X} = \begin{bmatrix} 25 &amp; 67 &amp; \cdots &amp; 1995 \\ 38 &amp; 63 &amp; \cdots &amp; 1982 \\ \vdots &amp;\vdots &amp; \ddots &amp; \vdots \\ 41 &amp; 59 &amp; \cdots &amp; 1979 \end{bmatrix}\qquad \mathbf{X}^T = \mathbf{X}' = \begin{bmatrix} 25 &amp; 38 &amp; \cdots &amp; 41 \\ 67 &amp; 63 &amp; \cdots &amp; 59 \\ \vdots &amp;\vdots &amp; \ddots &amp; \vdots \\ 1995 &amp; 1982 &amp; \cdots &amp; 1979 \end{bmatrix}\)`


The former columns (variables) are now rows. The former rows (participants) are now columns.

---

class:middle
.left[
### Transposing vectors and matrices
]

We can transpose a matrix using the `t()` function:

```r
t(dat)
```

```
##            [,1] [,2] [,3] [,4] [,5] [,6] [,7] [,8] [,9] [,10]
## age          25   38   35   36   23   26   44   23   25    41
## height       67   63   66   70   62   73   68   70   70    59
## likes_dogs    0    1    1    1    1    1    0    1    1     0
## yob        1995 1982 1985 1984 1997 1994 1976 1997 1995  1979
```
If we save this as another object, we can extract elements using the **opposite** indices as before:


```r
dat_t &lt;- t(dat)
dat[3, 4] # participant 3's year of birth
```

```
##  yob 
## 1985
```

```r
dat_t[4, 3]
```

```
##  yob 
## 1985
```

---
# Vector &amp; matrix multiplication

When we multiply a scalar by a vector or a matrix, we can just do so element by element:

`\(a\mathbf{y} = \begin{bmatrix} ay_1 \\ ay_2 \\ \vdots \\ ay_n \end{bmatrix} \qquad \qquad \qquad a\mathbf{X} = \begin{bmatrix} ax_{11} &amp; ax_{12} &amp; \cdots &amp; ax_{1p} \\ ax_{21} &amp; ax_{22} &amp; \cdots &amp; ax_{2p} \\ \vdots &amp;\vdots &amp; \ddots &amp; \vdots \\ ax_{n1} &amp; ax_{n2} &amp; \cdots &amp; ax_{np} \end{bmatrix}\)`

.center[
#### But multiplying vectors and matrices requires special rules
]
---

### Vector &amp; matrix multiplication

.left-col[
We can only multiply vectors of the same length, and we have to **transpose** one before we can do so.

- Consider two vectors of length `\(p\)`, `\(\mathbf{b}\)` and `\(\mathbf{c}\)`:

`\(\mathbf{b}^T\mathbf{c} = \begin{bmatrix} b_1 \\ b_2 \\ \vdots \\ b_p \end{bmatrix}^T \begin{bmatrix} c_1 \\ c_2 \\ \vdots \\ c_p \end{bmatrix}\)` 
`\(= \begin{bmatrix} b_1 &amp; b_2 &amp; \cdots &amp; b_p \end{bmatrix} \begin{bmatrix} c_1 \\ c_2 \\ \vdots \\ c_p \end{bmatrix}\)`
`\(=b_1c_1 + b_2c_2 + \cdots + b_pc_p\)` 
`\(= \sum_{i = 1}^p b_ic_i\)`
]


.right-col[

![](https://media.giphy.com/media/3WvdC5etwu52rLUAWm/giphy.gif)
]

---

# Matrix `\(\times\)` matrix multiplication

Let's multiply a `\(m\times n\)` matrix `\(\mathbf{Y}\)` by the `\(n\times p\)` matrix `\(\mathbf{X}\)`:

`\(\mathbf{Y}_{m\times n}\mathbf{X}_{n\times p} = \begin{bmatrix} \mathbf{y_{11}} &amp; \mathbf{y_{12}} &amp; \cdots &amp; \mathbf{y_{1n}} \\ y_{21} &amp; y_{22} &amp; \cdots &amp; y_{2n} \\ \vdots &amp;\vdots &amp; \ddots &amp; \vdots \\ y_{m1} &amp; y_{m2} &amp; \cdots &amp; y_{mn} \end{bmatrix} \begin{bmatrix} \mathbf{x_{11}} &amp; x_{12} &amp; \cdots &amp; x_{1p} \\ \mathbf{x_{21}} &amp; x_{22} &amp; \cdots &amp; x_{2p} \\ \vdots &amp;\vdots &amp; \ddots &amp; \vdots \\ \mathbf{x_{n1}} &amp; x_{n2} &amp; \cdots &amp; x_{np}\end{bmatrix}\)`
`\(= \begin{bmatrix} \mathbf{z_{11}} &amp;  &amp; \cdots &amp;  \\ &amp;  &amp; \cdots &amp; \\ \vdots &amp;\vdots &amp; \ddots &amp; \vdots \\  &amp;  &amp; \cdots &amp;\end{bmatrix}\)`

where `\(\mathbf{z}_{11}\)` is the product of the first **row** of `\(\mathbf{Y}\)` and the first **column** of `\(\mathbf{Y}\)`

---

# Matrix `\(\times\)` matrix multiplication

Now we do the same vector-vector multiplication with every pair of a row from `\(\mathbf{Y}\)` and a column from `\(\mathbf{X}\)`

`\(\mathbf{Y}_{m\times n}\mathbf{X}_{n\times p} = \begin{bmatrix} \mathbf{y_{11}} &amp; \mathbf{y_{12}} &amp; \cdots &amp; \mathbf{y_{1n}} \\ y_{21} &amp; y_{22} &amp; \cdots &amp; y_{2n} \\ \vdots &amp;\vdots &amp; \ddots &amp; \vdots \\ y_{m1} &amp; y_{m2} &amp; \cdots &amp; y_{mn} \end{bmatrix} \begin{bmatrix} x_{11} &amp; \mathbf{x_{12}} &amp; \cdots &amp; x_{1p} \\ x_{21} &amp; \mathbf{x_{22}} &amp; \cdots &amp; x_{2p} \\ \vdots &amp;\vdots &amp; \ddots &amp; \vdots \\ x_{n1} &amp; \mathbf{x_{n2}} &amp; \cdots &amp; x_{np} \end{bmatrix}\)`
`\(= \begin{bmatrix} z_{11} &amp; \mathbf{z_{12}} &amp; \cdots &amp;  \\ &amp;  &amp; \cdots &amp; \\ \vdots &amp;\vdots &amp; \ddots &amp; \vdots \\ &amp;  &amp; \cdots &amp; \end{bmatrix}\)`

(You don't have to do it in any particular order, just keep multiplying until all row-column pairs have been multiplied.)

.center[
#### What will be the dimensions of `\(\mathbf{Z}\)`?
]

---
## (Note on dimensions)

Notice that I explicitly wrote out the dimensions when multiplying `\(\mathbf{Y}_{m\times n}\mathbf{X}_{n\times p}\,\)`

Just like we can only multiply vectors of the same length, dimensions of matrices must be compatible in order to be multiplied.

.center[
&lt;iframe src="https://giphy.com/embed/ZDgXvr2vpsgZG" width="480" height="257" frameBorder="0" class="giphy-embed" allowFullScreen&gt;&lt;/iframe&gt;&lt;p&gt;&lt;a href="https://giphy.com/gifs/ZDgXvr2vpsgZG"&gt;&lt;/a&gt;&lt;/p&gt;
]

The **inner dimensions** must match, then the resulting product is a matrix with the **outer dimensions**.

.center[
#### I think of this as the inner dimensions "collapsing"
]
---

### Matrix `\(\times\)` matrix multiplication


```r
X &lt;- matrix(c(6, 3, 1, 6, 2, 3), ncol = 3)
X
```

```
##      [,1] [,2] [,3]
## [1,]    6    1    2
## [2,]    3    6    3
```

```r
tX = t(X)
tX
```

```
##      [,1] [,2]
## [1,]    6    3
## [2,]    1    6
## [3,]    2    3
```

```r
Z = tX%*%X
Z
```

```
##      [,1] [,2] [,3]
## [1,]   45   24   21
## [2,]   24   37   20
## [3,]   21   20   13
```

---

### Matrix `\(\times\)` matrix multiplication


```r
Z = tX%*%X
Z
```

```
##      [,1] [,2] [,3]
## [1,]   45   24   21
## [2,]   24   37   20
## [3,]   21   20   13
```

```r
X[,1]%*%tX[1,]
```

```
##      [,1]
## [1,]   45
```


---
# Identity matrix

We all know 1 is special. When you multiply a number by 1, you get the same number.

Matrices have their own special matrix, the identity matrix: `\(\mathbf{I}\)`.

.center[
`\(\mathbf{XI} = \mathbf{X} \text{ for any matrix } \mathbf{X}\)`
]

&lt;br&gt;
--

For example:

`\(\mathbf{QI} = \begin{bmatrix} r &amp; s &amp; t \\ u &amp; v &amp; w \end{bmatrix}_{2\times3}\begin{bmatrix} 1 &amp; 0 &amp; \cdots &amp; 0 \\ 0 &amp; 1 &amp; 0 \cdots &amp; 0 \\ \vdots &amp; \vdots &amp; \ddots &amp; \vdots \\ 0 &amp; 0 &amp; \cdots &amp; 1\end{bmatrix}_{3\times3} = \begin{bmatrix} r &amp; s &amp; t \\ u &amp; v &amp; w \end{bmatrix}_{2\times3}\)`

---
# Symmetrical matrixes

The identity matrix `\(\mathbf{I}\)` is an example of a symmetric matrix: `\(\mathbf{I}_{i,j}\)` = `\(\mathbf{I}_{j,i}\)` for any `\(i\)`, `\(j\)` where `\(i \ne j\)`

If you multiply a matrix by itself, the result is also a symmetric matrix:

.center[
`\(\mathbf{Q}^T\mathbf{Q} = \begin{bmatrix} r^2 + u^2 &amp; rs + uv &amp; rt + uw \\ rs + uv &amp; s^2 + v^2 &amp; st + vw \\ rt + uw &amp; st + vw &amp; t^2 + w^2 \end{bmatrix}\)`
]

---

### Inverse of a matrix and linear independence

The inverse of a matrix `\(\mathbf{Q}\)` is the matrix `\(\mathbf{Q^{-1}}\)` such that `$$\mathbf{Q}\mathbf{Q^{-1}} = \mathbf{I}$$`

- For a scalar `\(a\)`, `\(a^{-1}=\frac{1}{a}\)` is the multiplicative inverse of `\(a\)`: when we multiply the two together, we get 1
- For a matrix, the inverse is much more difficult to find, and does not exist if the columns are **linearly dependent**

---

### Inverse of a matrix and linear independence


Consider a situation in which we're predicting height as a linear function of several variables we have in our dataset: age in years, shoe size, and age in months.

.center[

`\(\textbf{height} = \begin{bmatrix} 51 \\ 61 \\ 52 \\ 65 \\ 60 \\ 48 \end{bmatrix} \qquad \qquad \textbf{other variables} = \begin{bmatrix} 30  &amp; 7 &amp; 360 \\ 31 &amp; 10 &amp; 372 \\ 25 &amp; 9 &amp; 300 \\ 35 &amp; 10 &amp; 420 \\ 42 &amp; 6 &amp; 504 \\ 27 &amp; 7 &amp; 324 \end{bmatrix}\)`

]

.pull-left[
We can plot predicted height as a function of age in years alone. This is a line.
]

.pull-right[

.center[

<div id="htmlwidget-97c534e0866c52485a8f" style="width:220px;height:220px;" class="plotly html-widget"></div>
<script type="application/json" data-for="htmlwidget-97c534e0866c52485a8f">{"x":{"visdat":{"deac74274432":["function () ","plotlyVisDat"]},"cur_data":"deac74274432","attrs":{"deac74274432":{"x":{},"y":{},"mode":"markers","alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"scatter"},"deac74274432.1":{"x":{},"y":{},"mode":"lines","alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"scatter","color":["lightgrey"],"inherit":true}},"layout":{"width":220,"height":220,"margin":{"b":40,"l":60,"t":25,"r":10},"xaxis":{"domain":[0,1],"automargin":true,"title":"age in years"},"yaxis":{"domain":[0,1],"automargin":true,"title":"predicted height"},"showlegend":false,"autosize":false,"hovermode":"closest"},"source":"A","config":{"showSendToCloud":false},"data":[{"x":[30,31,25,35,42,27],"y":[54.9181494661922,55.6672597864769,51.1725978647687,58.6637010676157,63.9074733096085,52.6708185053381],"mode":"markers","type":"scatter","marker":{"color":"rgba(31,119,180,1)","line":{"color":"rgba(31,119,180,1)"}},"error_y":{"color":"rgba(31,119,180,1)"},"error_x":{"color":"rgba(31,119,180,1)"},"line":{"color":"rgba(31,119,180,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":[25,27,30,31,35,42],"y":[51.1725978647687,52.6708185053381,54.9181494661922,55.6672597864769,58.6637010676157,63.9074733096085],"mode":"lines","type":"scatter","marker":{"color":"rgba(211,211,211,1)","line":{"color":"rgba(211,211,211,1)"}},"textfont":{"color":"rgba(211,211,211,1)"},"error_y":{"color":"rgba(211,211,211,1)"},"error_x":{"color":"rgba(211,211,211,1)"},"line":{"color":"rgba(211,211,211,1)"},"xaxis":"x","yaxis":"y","frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
]

]

---
# Linear independence, cont.

.pull-left[
If we plot predicted height as a function of age in years *and* shoe size, we get a **plane**.

&lt;br&gt;
&lt;br&gt;
&lt;br&gt;
&lt;br&gt;
&lt;br&gt;

That is, we get more information about height from knowing someone's shoe size. If two people are the same age, but have different shoe sizes, we'll predict different heights for them.
]

.pull-right[
.center[

<div id="htmlwidget-1bfd6adcfaced3986267" style="width:400px;height:400px;" class="plotly html-widget"></div>
<script type="application/json" data-for="htmlwidget-1bfd6adcfaced3986267">{"x":{"visdat":{"deac6f7dd6ba":["function () ","plotlyVisDat"]},"cur_data":"deac6f7dd6ba","attrs":{"deac6f7dd6ba":{"x":{},"z":{},"y":{},"mode":"markers","alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"scatter3d"},"deac6f7dd6ba.1":{"x":{},"z":{},"y":{},"mode":"markers","alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"surface","colorscale":[[0,1],["lightgrey","lightgrey"]],"inherit":true}},"layout":{"width":400,"height":400,"margin":{"b":40,"l":60,"t":25,"r":10},"scene":{"yaxis":{"title":"age in years"},"xaxis":{"title":"shoe size"},"zaxis":{"title":"predicted height"},"camera":{"up":{"x":0,"y":0,"z":1},"eye":{"x":2.5,"y":0.01,"z":0.2},"center":{"x":0,"y":0,"z":0.2}}},"showlegend":false,"hovermode":"closest"},"source":"A","config":{"showSendToCloud":false},"data":[{"x":[7,10,9,10,6,7],"z":[51,61,52,65,60,48],"y":[30,31,25,35,42,27],"mode":"markers","type":"scatter3d","marker":{"color":"rgba(31,119,180,1)","line":{"color":"rgba(31,119,180,1)"},"showscale":false},"error_y":{"color":"rgba(31,119,180,1)"},"error_x":{"color":"rgba(31,119,180,1)"},"line":{"color":"rgba(31,119,180,1)"},"frame":null},{"colorbar":{"title":"p_age_shoe<br />m_shoes","ticklen":2},"colorscale":[[0,"lightgrey"],[1,"lightgrey"]],"showscale":false,"x":[7,10,9,6],"z":[[51,60,57,48],[52,61,58,49],[46,55,52,43],[56,65,62,53],[63,72,69,60],[48,57,54,45]],"y":[30,31,25,35,42,27],"mode":"markers","type":"surface","frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
]
]


---
# Linear dependence

.pull-left[
But if we plot predicted height as a function of age in years and *age in months*, we get a line again, instead of a plane.

&lt;br&gt;
&lt;br&gt;


That's because age in years and age in months are **linearly dependent**: we can write one as a linear combination of the others; that is, age in months = 12 `\(\times\)` age in years.

We don't get any extra information from knowing age in months that we didn't already have from age in years.
]

.pull-right[
.center[
<div id="htmlwidget-3ed1330c82c6ca6570dc" style="width:400px;height:400px;" class="plotly html-widget"></div>
<script type="application/json" data-for="htmlwidget-3ed1330c82c6ca6570dc">{"x":{"visdat":{"deac26439dab":["function () ","plotlyVisDat"]},"cur_data":"deac26439dab","attrs":{"deac26439dab":{"x":{},"z":{},"y":{},"mode":"markers","alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"scatter3d"},"deac26439dab.1":{"x":{},"z":{},"y":{},"mode":"lines","alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"scatter3d","color":["lightgrey"],"inherit":true}},"layout":{"width":400,"height":400,"margin":{"b":40,"l":60,"t":25,"r":10},"scene":{"yaxis":{"title":"age in years"},"xaxis":{"title":"age in months"},"zaxis":{"title":"height"},"camera":{"up":{"x":0,"y":0,"z":1},"eye":{"x":2.5,"y":0.01,"z":0.2},"center":{"x":0,"y":0,"z":0.2}}},"showlegend":false,"hovermode":"closest"},"source":"A","config":{"showSendToCloud":false},"data":[{"x":[360,372,300,420,504,324],"z":[54.9181494661922,55.6672597864769,51.1725978647687,58.6637010676157,63.9074733096085,52.6708185053381],"y":[30,31,25,35,42,27],"mode":"markers","type":"scatter3d","marker":{"color":"rgba(31,119,180,1)","line":{"color":"rgba(31,119,180,1)"}},"error_y":{"color":"rgba(31,119,180,1)"},"error_x":{"color":"rgba(31,119,180,1)"},"line":{"color":"rgba(31,119,180,1)"},"frame":null},{"x":[300,324,360,372,420,504],"z":[51.1725978647687,52.6708185053381,54.9181494661922,55.6672597864769,58.6637010676157,63.9074733096085],"y":[25,27,30,31,35,42],"mode":"lines","type":"scatter3d","marker":{"color":"rgba(211,211,211,1)","line":{"color":"rgba(211,211,211,1)"}},"textfont":{"color":"rgba(211,211,211,1)"},"error_y":{"color":"rgba(211,211,211,1)"},"error_x":{"color":"rgba(211,211,211,1)"},"line":{"color":"rgba(211,211,211,1)"},"frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
]
]

.center[
#### When else do you think linear dependence might be a problem?
]

---
# In "real life"

Linear dependence will come into play when we cover regression. In the meantime, we can practice some regression matrix notation! You may be used to seeing a linear regression equation written out like this:

.center[
`\(y_i = \beta_0 + \beta_1x_{1i} +\beta_1x_{2i} + \epsilon_i\)`
]

Well, that's the same thing as:

.center[
`\(y_i = \boldsymbol{\beta}^T\mathbf{x}_i + \epsilon_i\)`
]

where
`\(\;\boldsymbol{\beta} = \begin{bmatrix} \beta_0 \\ \beta_1 \\ \beta_2 \end{bmatrix}_{3 \times 1}\;\)` and `\(\;\mathbf{x}_i = \begin{bmatrix} 1 \\ x_{i1} \\ x_{i2} \end{bmatrix}_{3 \times 1}\)`

&lt;br&gt;

.center[
#### Try multiplying it out by hand, first making sure the dimensions are compatible (notice the necessity to transpose `\(\;\boldsymbol{\beta}\)`)!
]

Stay tuned for more on this when we cover regression analysis 😁

---
# In R
.pull-left[
We can attempt to invert a matrix using the `solve()` function:



```r
mat_a
```

```
##      [,1] [,2]
## [1,]    2    1
## [2,]    6    8
```

```r
solve(mat_a)
```

```
##      [,1] [,2]
## [1,]  0.8 -0.1
## [2,] -0.6  0.2
```
]


.pull-right[

We can check to make sure this is the inverse:


```r
mat_a_inv &lt;- solve(mat_a)
mat_a_inv %*% mat_a
```

```
##      [,1] [,2]
## [1,]    1    0
## [2,]    0    1
```
#### We get the identity matrix `\(\mathbf{I}\)`!
]

---
# In R, cont.

What if we have a matrix whose columns are not linearly independent?




```r
mat_b
```

```
##      [,1] [,2]
## [1,]    2    1
## [2,]    6    3
```

```r
solve(mat_b)
```

```
## Error in solve.default(mat_b): Lapack routine dgesv: system is exactly singular: U[2,2] = 0
```

#### Whenever you get an error message about something being "singular", that's code for a matrix not being invertible -- check for linear dependence! 

How could you tell the matrix above is not invertible?


---
class:middle

background-image: url("img/resources.jpg")

background-size:cover


# More resources

.pull-left[

[**This**](https://www.khanacademy.org/math/precalculus/precalc-matrices) whole section has a lot of great information and practice with matrices. 

For a more advanced introduction, work through the sections on vectors, linear combinations, and linear dependence [**here**](https://www.khanacademy.org/math/linear-algebra/vectors-and-spaces). 

You can also pick and choose from the videos [**here**](https://www.khanacademy.org/math/linear-algebra/matrix-transformations), particularly those on functions and linear transformations.
]

---

class:middle,center
.left[
# Part 2: Functions, data transformations and a sprinkle of calculus
]

#### Now that we've explored how data is stored, let's look at how data can be transformed 

---
# Logarithms

.left-code[
If you see `\(\log(x)\)` in this class, or basically anywhere in probability and statistics, it will refer to the natural logarithm, or `\(\ln(x)\)`.

#### What do you notice about the function `\(\log(x)\)`?

&lt;br&gt;
&lt;br&gt;
&lt;br&gt;
&lt;br&gt;

You can only "log" a positive number. Something like `\(\log(-1)\)` is undefined. We can see that `\(\lim_{x \to 0}\log(x) = -\infty\)`. Importantly, `\(\log(1) = 0\)`, so `\(\log(x)\)` for any `\(x\)` between 0 and 1 will give you a negative number.
]

.right-plot[

&lt;img src="index_files/figure-html/logGraph-1.png" width="100%" style="display: block; margin: auto;" /&gt;
]

---
# Exponentiation
.left-code[
The **inverse** of the natural log is the natural expontial function `\(e^x\)`, which we also write as `\(\exp(x)\)`:

.center[
`\(\exp(x) = y \iff x = \log(y)\)`
]

so if one side of an equation is exponentiated, we can always "get out of it" by applying a logarithm to both sides, and vice versa.

.center[
`\(\log(\exp(x)) = x\;\)` and `\(\;\exp(\log(x)) = x\)`
]

#### But we can't do that if x is negative! Recall that we can't take a log of a negative number, and exponentiating a number is never going to give us anything negative.
]

.right-plot[

&lt;img src="index_files/figure-html/expGraph-1.png" width="100%" style="display: block; margin: auto;" /&gt;
]

---
# Rules to live by

When we have a sum inside an exponent, we can decompose this into the product of two exponents:
`$$\exp(a + b) = \exp(a)\exp(b)$$`
Similarly, a product inside a logarithm can be written as a sum of logs:
`$$\log(ab) = \log(a) + \log(b)$$`
Of course, the same is true of the inverses of addition and multiplication, subtraction and division:
`$$\exp(a - b) = \frac{\exp(a)}{\exp(b)}$$`
`$$\log\left(\frac{a}{b}\right) = \log(a) - \log(b)$$`

#### You will need to know these rules to understand various regression models in this class, I promise!

---
# Odds and probabilities
.pull-left[
Another important relationship! Think about flipping a coin lots of times: heads you win, tails you lose.

- A **probability** describes the number of successes out of the total number of trials (a proportion)
- An **odds** describes the number of successes compared the the number of failures (a ratio)

Let's say you get 4 heads out of 10 flips:

- probability = `\(\frac{4}{10}\)`
- odds = `\(\frac{4}{6}\)`

#### These are really different numbers!

]

.pull-right[
![](https://i0.wp.com/harvardsportsanalysis.org/wp-content/uploads/2015/11/CTAVzLbVAAAVm7B.jpg-large.jpg?w=1024)

&lt;br&gt;
&lt;br&gt;
&lt;br&gt;
.center[
`\(odds = \frac{prob}{1 - prob}\)`


`\(prob = \frac{odds}{1 + odds}\)`
]
]

---
# Logits and expits
.pull-left[
Now let's combine everything to make... the **logit** function!

![](img/recipe.gif)
]

.pull-right[

The **logit** of `\(p\)`, aka the **log-odds** of `\(p\)`, can take a number between 0 and 1 (like a probability!) and transform it to a number between `\(-\infty\)` and `\(\infty\)`.

.center[
`\(logit(p) = \log\left(\frac{p}{1 - p}\right)\)`
]

We can invert it to get the **expit** function, which can take any number on the real line and transform it to a value between 0 and 1:

.center[
`\(expit(x) = \frac{\exp(x)}{1 + \exp(x)}\)`
]

]
---

### Back to the data example:


```
##    age height likesdogs  yob
## 1   25     67         0 1995
## 2   38     63         1 1982
## 3   35     66         1 1985
## 4   36     70         1 1984
## 5   23     62         1 1997
## 6   26     73         1 1994
## 7   44     68         0 1976
## 8   23     70         1 1997
## 9   25     70         1 1995
## 10  41     59         0 1979
```

We know (since we simulated the data) that in the population:
- `\(p\)` = 0.53 like dogs, which translates to the following logit:
- `\(logit(0.53) = \log\left(\frac{0.53}{1 - 0.53}\right) = 0.052\)`

In this sample:
- `\(p_{sample}\)` = `\(\sum{likesdogs_i}\)` = `\((0+1+1+1+1+1+0+1+1+0)/10 = 0.7\)`

#### How do we model the probability of whether each person likes dogs?

---

### Back to the data example:

Consider the following logistic regression model for the probability that someone likes dogs ( `\(p_i\)` ) given their age in years ( `\(x_i\)` ):

`\(\log\left(\frac{p_i}{1-p_i}\right) = \beta_0 + \beta_1x_i\)`

#### What's the probability that a 30-year-old likes dogs?

.pull-left[
.center[

`\(\log\left(\frac{p_i}{1-p_i}\right) = \beta_0 + \beta_1\times30\)`

`\(\frac{p_i}{1-p_i} = \exp\left(\beta_0 + \beta_1\times30\right)\)`

`\(p_i = \frac{\exp\left(\beta_0 + \beta_1\times30\right)}{1 + \exp\left(\beta_0 + \beta_1\times30\right)}\)`
]
]

.pull-right[
![](https://hips.hearstapps.com/ghk.h-cdn.co/assets/17/30/1500925839-golden-retriever-puppy.jpg)
]
    </textarea>
<style data-target="print-only">@media screen {.remark-slide-container{display:block;}.remark-slide-scaler{box-shadow:none;}}</style>
<script src="https://remarkjs.com/downloads/remark-latest.min.js"></script>
<script>var slideshow = remark.create();
if (window.HTMLWidgets) slideshow.on('afterShowSlide', function (slide) {
  window.dispatchEvent(new Event('resize'));
});
(function(d) {
  var s = d.createElement("style"), r = d.querySelector(".remark-slide-scaler");
  if (!r) return;
  s.type = "text/css"; s.innerHTML = "@page {size: " + r.style.width + " " + r.style.height +"; }";
  d.head.appendChild(s);
})(document);

(function(d) {
  var el = d.getElementsByClassName("remark-slides-area");
  if (!el) return;
  var slide, slides = slideshow.getSlides(), els = el[0].children;
  for (var i = 1; i < slides.length; i++) {
    slide = slides[i];
    if (slide.properties.continued === "true" || slide.properties.count === "false") {
      els[i - 1].className += ' has-continuation';
    }
  }
  var s = d.createElement("style");
  s.type = "text/css"; s.innerHTML = "@media print { .has-continuation { display: none; } }";
  d.head.appendChild(s);
})(document);
// delete the temporary CSS (for displaying all slides initially) when the user
// starts to view slides
(function() {
  var deleted = false;
  slideshow.on('beforeShowSlide', function(slide) {
    if (deleted) return;
    var sheets = document.styleSheets, node;
    for (var i = 0; i < sheets.length; i++) {
      node = sheets[i].ownerNode;
      if (node.dataset["target"] !== "print-only") continue;
      node.parentNode.removeChild(node);
    }
    deleted = true;
  });
})();
(function() {
  "use strict"
  // Replace <script> tags in slides area to make them executable
  var scripts = document.querySelectorAll(
    '.remark-slides-area .remark-slide-container script'
  );
  if (!scripts.length) return;
  for (var i = 0; i < scripts.length; i++) {
    var s = document.createElement('script');
    var code = document.createTextNode(scripts[i].textContent);
    s.appendChild(code);
    var scriptAttrs = scripts[i].attributes;
    for (var j = 0; j < scriptAttrs.length; j++) {
      s.setAttribute(scriptAttrs[j].name, scriptAttrs[j].value);
    }
    scripts[i].parentElement.replaceChild(s, scripts[i]);
  }
})();
(function() {
  var links = document.getElementsByTagName('a');
  for (var i = 0; i < links.length; i++) {
    if (/^(https?:)?\/\//.test(links[i].getAttribute('href'))) {
      links[i].target = '_blank';
    }
  }
})();</script>

<script>
slideshow._releaseMath = function(el) {
  var i, text, code, codes = el.getElementsByTagName('code');
  for (i = 0; i < codes.length;) {
    code = codes[i];
    if (code.parentNode.tagName !== 'PRE' && code.childElementCount === 0) {
      text = code.textContent;
      if (/^\\\((.|\s)+\\\)$/.test(text) || /^\\\[(.|\s)+\\\]$/.test(text) ||
          /^\$\$(.|\s)+\$\$$/.test(text) ||
          /^\\begin\{([^}]+)\}(.|\s)+\\end\{[^}]+\}$/.test(text)) {
        code.outerHTML = code.innerHTML;  // remove <code></code>
        continue;
      }
    }
    i++;
  }
};
slideshow._releaseMath(document);
</script>
<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
(function () {
  var script = document.createElement('script');
  script.type = 'text/javascript';
  script.src  = 'https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML';
  if (location.protocol !== 'file:' && /^https?:/.test(script.src))
    script.src  = script.src.replace(/^https?:/, '');
  document.getElementsByTagName('head')[0].appendChild(script);
})();
</script>
  </body>
</html>
